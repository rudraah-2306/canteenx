{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Rudraah/Desktop/Canteen/canteenx/frontend/pages/cart.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport { useAuthStore, useCartStore } from '@/store';\r\nimport { supabase } from '@/lib/supabaseClient';\r\nimport { motion } from 'framer-motion';\r\nimport { Trash2, ShoppingBag, Calendar, Clock } from 'lucide-react';\r\nimport Link from 'next/link';\r\n\r\nexport default function Cart() {\r\n  const router = useRouter();\r\n  const { user } = useAuthStore();\r\n  const { items, totalPrice, removeItem, updateQuantity, clearCart } = useCartStore();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    paymentMethod: 'cash',\r\n    pickupTime: '',\r\n    scheduledFor: new Date().toISOString().split('T')[0],\r\n    notes: '',\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      router.push('/login');\r\n    }\r\n  }, [user, router]);\r\n\r\n  if (!user) return null;\r\n\r\n  const handleChange = (e: any) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleSubmitOrder = async () => {\r\n    if (!formData.pickupTime || !formData.scheduledFor) {\r\n      alert('Please select pickup time and date');\r\n      return;\r\n    }\r\n\r\n    if (items.length === 0) {\r\n      alert('Cart is empty');\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const orderItems = items.map((item) => ({\r\n        foodItemId: item.foodItemId,\r\n        quantity: item.quantity,\r\n        notes: item.notes,\r\n      }));\r\n\r\n      const pickupDateTime = new Date(\r\n        `${formData.scheduledFor}T${formData.pickupTime}`\r\n      );\r\n\r\n      const { error } = await supabase.from('orders').insert([\r\n        {\r\n          user_id: user?.id,\r\n          items: orderItems,\r\n          paymentMethod: formData.paymentMethod,\r\n          pickupTime: pickupDateTime.toISOString(),\r\n          scheduledFor: formData.scheduledFor,\r\n          notes: formData.notes,\r\n          totalAmount: totalPrice + Math.round(totalPrice * 0.05),\r\n          status: 'pending',\r\n          paymentStatus: 'pending',\r\n          createdAt: new Date().toISOString(),\r\n        },\r\n      ]);\r\n\r\n      if (error) {\r\n        alert(error.message || 'Failed to place order');\r\n      } else {\r\n        clearCart();\r\n        router.push(`/orders?success=true`);\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  if (items.length === 0) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-950 dark:to-black py-12\">\r\n        <div className=\"container mx-auto\">\r\n          <div className=\"text-center py-20\">\r\n            <ShoppingBag className=\"w-16 h-16 mx-auto text-gray-400 mb-4\" />\r\n            <h2 className=\"text-3xl font-bold mb-2\">Your cart is empty</h2>\r\n            <p className=\"text-gray-600 dark:text-gray-400 mb-8\">\r\n              Start adding items to place an order\r\n            </p>\r\n            <Link href=\"/menu\" className=\"btn btn-primary\">\r\n              Browse Menu\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-950 dark:to-black py-12\">\r\n      <div className=\"container mx-auto\">\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.5 }}\r\n        >\r\n          <h1 className=\"text-4xl font-bold mb-8\">Your Order</h1>\r\n\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n            {/* Cart Items */}\r\n            <div className=\"lg:col-span-2\">\r\n              <div className=\"card p-6 mb-6\">\r\n                <h2 className=\"text-2xl font-bold mb-4\">Order Items</h2>\r\n                <div className=\"space-y-4\">\r\n                  {items.map((item) => (\r\n                    <div\r\n                      key={item.foodItemId}\r\n                      className=\"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg\"\r\n                    >\r\n                      <div className=\"flex-1\">\r\n                        <h3 className=\"font-semibold\">{item.name}</h3>\r\n                        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                          ₹{item.price} each\r\n                        </p>\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center gap-4\">\r\n                        <div className=\"flex items-center bg-gray-200 dark:bg-gray-700 rounded-lg\">\r\n                          <button\r\n                            onClick={() =>\r\n                              updateQuantity(\r\n                                item.foodItemId,\r\n                                Math.max(1, item.quantity - 1)\r\n                              )\r\n                            }\r\n                            className=\"px-3 py-1 text-gray-600 dark:text-gray-400\"\r\n                          >\r\n                            −\r\n                          </button>\r\n                          <span className=\"px-3 py-1 font-semibold min-w-[2rem] text-center\">\r\n                            {item.quantity}\r\n                          </span>\r\n                          <button\r\n                            onClick={() =>\r\n                              updateQuantity(item.foodItemId, item.quantity + 1)\r\n                            }\r\n                            className=\"px-3 py-1 text-gray-600 dark:text-gray-400\"\r\n                          >\r\n                            +\r\n                          </button>\r\n                        </div>\r\n\r\n                        <span className=\"font-bold min-w-[4rem] text-right\">\r\n                          ₹{item.price * item.quantity}\r\n                        </span>\r\n\r\n                        <button\r\n                          onClick={() => removeItem(item.foodItemId)}\r\n                          className=\"p-2 hover:bg-red-100 dark:hover:bg-red-900 text-red-500 rounded-lg transition-colors\"\r\n                        >\r\n                          <Trash2 className=\"w-5 h-5\" />\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Order Details */}\r\n              <div className=\"card p-6\">\r\n                <h2 className=\"text-2xl font-bold mb-4\">Order Details</h2>\r\n                <div className=\"space-y-4\">\r\n                  {/* Date */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold mb-2 flex items-center gap-2\">\r\n                      <Calendar className=\"w-4 h-4\" /> Pickup Date\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      name=\"scheduledFor\"\r\n                      value={formData.scheduledFor}\r\n                      onChange={handleChange}\r\n                      min={new Date().toISOString().split('T')[0]}\r\n                      className=\"input\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Time */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold mb-2 flex items-center gap-2\">\r\n                      <Clock className=\"w-4 h-4\" /> Pickup Time\r\n                    </label>\r\n                    <input\r\n                      type=\"time\"\r\n                      name=\"pickupTime\"\r\n                      value={formData.pickupTime}\r\n                      onChange={handleChange}\r\n                      className=\"input\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Payment Method */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold mb-2\">\r\n                      Payment Method\r\n                    </label>\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"flex items-center\">\r\n                        <input\r\n                          type=\"radio\"\r\n                          name=\"paymentMethod\"\r\n                          value=\"cash\"\r\n                          checked={formData.paymentMethod === 'cash'}\r\n                          onChange={handleChange}\r\n                          className=\"w-4 h-4\"\r\n                        />\r\n                        <span className=\"ml-2\">Pay at Counter (Cash)</span>\r\n                      </label>\r\n                      <label className=\"flex items-center\">\r\n                        <input\r\n                          type=\"radio\"\r\n                          name=\"paymentMethod\"\r\n                          value=\"online\"\r\n                          checked={formData.paymentMethod === 'online'}\r\n                          onChange={handleChange}\r\n                          className=\"w-4 h-4\"\r\n                        />\r\n                        <span className=\"ml-2\">Online Payment</span>\r\n                      </label>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Notes */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold mb-2\">\r\n                      Special Instructions (Optional)\r\n                    </label>\r\n                    <textarea\r\n                      name=\"notes\"\r\n                      value={formData.notes}\r\n                      onChange={handleChange}\r\n                      placeholder=\"Any special requests?\"\r\n                      className=\"input h-24 resize-none\"\r\n                    ></textarea>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Order Summary */}\r\n            <div className=\"lg:col-span-1\">\r\n              <div className=\"card p-6 sticky top-24\">\r\n                <h2 className=\"text-2xl font-bold mb-6\">Order Summary</h2>\r\n\r\n                <div className=\"space-y-4 mb-6 pb-6 border-b border-gray-200 dark:border-gray-700\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600 dark:text-gray-400\">Subtotal</span>\r\n                    <span className=\"font-semibold\">₹{totalPrice}</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600 dark:text-gray-400\">Delivery Fee</span>\r\n                    <span className=\"font-semibold\">₹0</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600 dark:text-gray-400\">Tax</span>\r\n                    <span className=\"font-semibold\">\r\n                      ₹{Math.round(totalPrice * 0.05)}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center mb-6\">\r\n                  <span className=\"text-lg font-bold\">Total</span>\r\n                  <span className=\"text-3xl font-black text-accent-500\">\r\n                    ₹{totalPrice + Math.round(totalPrice * 0.05)}\r\n                  </span>\r\n                </div>\r\n\r\n                <button\r\n                  onClick={handleSubmitOrder}\r\n                  disabled={isLoading}\r\n                  className=\"w-full btn btn-primary py-3 font-semibold mb-3\"\r\n                >\r\n                  {isLoading ? 'Placing Order...' : 'Place Order'}\r\n                </button>\r\n\r\n                <button\r\n                  onClick={() => router.push('/menu')}\r\n                  className=\"w-full btn btn-secondary py-3 font-semibold\"\r\n                >\r\n                  Continue Shopping\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </motion.div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}